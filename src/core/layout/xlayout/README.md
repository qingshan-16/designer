# XLayout 树形布局算法说明文档

## 概述

XLayout 是一个用于树形结构的布局算法，采用数学坐标系（右上为正方向）。支持自左向右（LR）和自上向下（TB）两种布局方向，能够自动处理分支节点的权重排序和碰撞避免。

### 主要特性

- **原子树布局**：处理不含嵌套分支的简单树结构
- **分支排序**：按节点权重自动排序分支位置
- **动态偏移**：根据前序分支位置自动计算偏移量
- **多层级布局**：支持嵌套分支结构的层级化处理
- **坐标系调整**：支持整体布局的坐标平移

## 核心类说明

### 1. AtomicTreeLayout（原子树布局）

处理单个分支的布局逻辑

**属性**：

- `nodes`: 节点列表
- `startNode/endNode`: 分支起止节点
- `config`: 布局配置

**核心方法**：

- `layout()`: 执行布局流程
- `branchLayout()`: 处理单分支布局
- `repositionTree()`: 整体坐标调整

### 2. XLayout（主布局器）

管理整体布局流程

**功能**：

- 初始化节点/边关系
- 识别原子树和分支树
- 分层级处理嵌套结构
- 协调各分支布局

### 3. LayoutConfig（布局配置）

```typescript
{
  horizontalSpacing: 40, // 水平间距
  verticalSpacing: 80,   // 垂直间距
  rankdir: "LR"         // 布局方向(LR/TB)
}